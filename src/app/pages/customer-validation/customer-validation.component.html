<div class="grid">
  <div class="col-12">
    <div class="card px-6 py-6">
      <p-toast></p-toast>

      <p-toolbar styleClass="mb-4">
        <ng-template pTemplate="left">
          <div class="card flex justify-content-center gap-3">
            <a routerLink="/app/bulk-customer-validation"   class="p-button font-bold">
              <i class="pi pi-upload"></i>  
            </a>
        </div>
        </ng-template>

        <ng-container pTemplate="center" *ngIf="hasErrors">
          <button
            pButton
            label="Download Error Logs"
            (click)="downloadErrorLogs()"
          ></button>
        </ng-container>

        <ng-template pTemplate="right">
          <button
          [loading]="loading"
            pButton
            pRipple
            label="Export"
            icon="pi pi-download"
            class="p-button-help"
            (click)="exportData()"
          ></button>
        </ng-template>
        
      </p-toolbar>

      <p-table
        #dt1
        [value]="batches"
        [paginator]="true"
        [rows]="10"
        sortMode="multiple"
        [globalFilterFields]="['batchCode', 'startDate']"
      >

      <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between">
            <h5 class="m-0">Customer Vadilation</h5>
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text" [(ngModel)]="searchValue" #filter (input)="onGlobalFilter(dt1, $event)" placeholder="Keyword Search">
            </span>
        </div>
    </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="batchCode">
              Batch Code <p-sortIcon field="batchCode"></p-sortIcon>
            </th>
            <th pSortableColumn="startDate">
              Start Date <p-sortIcon field="startDate"></p-sortIcon>
            </th>
            <th pSortableColumn="endDate">
              End Date <p-sortIcon field="endDate"></p-sortIcon>
            </th>
            <th pSortableColumn="status">
              Status <p-sortIcon field="status"></p-sortIcon>
            </th>
            <th pSortableColumn="uploadedBy">
              Uploaded By <p-sortIcon field="uploadedBy"></p-sortIcon>
            </th>

            <th pSortableColumn="uploadedBy">
              FileName <p-sortIcon field="uploadedBy"></p-sortIcon>
            </th>

            <th pSortableColumn="uploadedBy">
              FileSize <p-sortIcon field="uploadedBy"></p-sortIcon>
            </th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-batch>
          <tr>
            <td>{{ batch.batchCode }}</td>
            <td>{{ batch.startDate ? (batch.endDate | date) : "N/A" }}</td>
            <td>{{ batch.endDate ? (batch.endDate | date) : "N/A" }}</td>
            <td>{{ batch.status }}</td>
            <td>{{ batch.uploadedBy }}</td>
            <td>{{ batch.fileName }}</td>
            <td>{{ batch.fileSize }}</td>


          </tr>
        </ng-template>
      </p-table>

      <!-- Progress Bar and Toast for Real-time Feedback -->
      <div class="p-col-12">
        <p-progressBar *ngIf="uploading" mode="indeterminate"></p-progressBar>
      </div>

      <!-- Download Error Logs Button -->
    </div>
  </div>
</div>

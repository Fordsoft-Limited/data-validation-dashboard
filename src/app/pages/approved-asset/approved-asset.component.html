<div class="card">
  <form [formGroup]="filterForm" (ngSubmit)="filterData()">
    <div class="flex gap-5 mb-4 justify-content-center flex-wrap">
      <div class="flex flex-column gap-2">
        <label for="region">Region:</label>
        <!-- <input type="text" formControlName="region" pInputText placeholder="Enter Region" class="region-input" /> -->
        <p-dropdown formControlName="region" [options]="regions"[editable]="true" (onChange)="onRegionChange($event)" placeholder="Enter Region"></p-dropdown>
      </div>

      <div class="flex flex-column gap-2">
        <label for="businessUnit">Business Unit:</label>
        <p-dropdown formControlName="businessUnit" [options]="businessUnits" [editable]="true" (onChange)="onBusinessHubChange($event)" placeholder="Select Business Unit"></p-dropdown>
      </div>

      <div class="flex flex-column gap-2">
        <label for="feeder">Service:</label>
        <p-dropdown formControlName="feeder" [options]="feeders" [editable]="true" placeholder="Select Service"></p-dropdown>
      </div>

    <div class="flex flex-column gap-2">
      <label for="dateRange">Date Range:</label>
      <div class="flex gap-2"> 
        <input type="date" formControlName="dateCreatedFrom" pInputText class="date-from" />
        <input type="date" formControlName="dateCreatedTo" pInputText class="date-to" />
      </div>
    </div>
      <div class="flex gap-2 mt-4">
        <p-button type="submit"  label="Filter"></p-button> 
        
      </div>
    </div>
  </form>

  <p-table [value]="filteredRecords" [loading]="loading" [paginator]="true" [rows]="100"
    (onRowSelect)="showDetails($event.data)" [scrollable]="true" 
    scrollHeight="400px">

    <ng-template pTemplate="caption">
      <div class="flex justify-content-end gap-2">
        <button 
        [loading]="loading"
        pButton
        pRipple
        class="p-button p-button-outlined font-bold p-button-help custom-button"
        icon="pi pi-download"
        (click)="exportData()"
        pTooltip="Export to Excel"
        tooltipPosition="bottom"
        style="width: 100px;"
      >
      </button>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <!-- <th style="width: 4rem"><p-tableRadioButton /></th> -->
        <th style="min-width:15rem">Customer No</th>
        <th style="min-width:15rem">Customer Name</th>
        <th style="min-width:15rem">Feeder</th>
        <th style="min-width:15rem">Status</th>
        <!-- <th style="min-width:10rem">Date Captured</th> -->
        <th style="min-width:10rem">Date Modified</th>
        <th style="min-width:6rem">Action</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-record>
      <tr class="cursor-pointer">
        <!-- <td><p-tableRadioButton [value]="record" /></td> -->
        <td>{{ record.customer_no }}</td>
        <td>{{ record.customer_full_name }}</td>
        <td>{{ record.feeder }}</td>
        <td> <p-tag [value]="record.approval_status" [severity]="getSeverity(record.approval_status)" /></td>
        <!-- <td>{{ record. date_created | date: 'MM/dd/yyyy' }}</td> -->
        <td>{{ record.last_modified | date: 'MM/dd/yyyy' }}</td>
        <td>
          <button pButton icon="pi pi-eye" class="p-button-text" (click)="viewDetails(record)"></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6">No records found.</td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog [(visible)]="showDetailsDialog" modal="modal" [closable]="true"
    [header]="selectedApprovedRecord?.customerFullName">
    <div *ngIf="selectedApprovedRecord" class="grid">
      <div class="col-12">
        <p><strong>Customer Full Name:</strong> {{ selectedApprovedRecord.customerFullName }}</p>
        <p><strong>Account No:</strong> {{ selectedApprovedRecord.cin }}</p>
        <p><strong>Feeder:</strong> {{ selectedApprovedRecord.feeder }}</p>
        <p><strong>Date Captured:</strong> {{ selectedApprovedRecord.date | date: 'MM/dd/yyyy' }}</p>
        <p><strong>Date Approved:</strong> {{ selectedApprovedRecord.dateApproved | date: 'MM/dd/yyyy' }}</p>

      </div>
    </div>
  </p-dialog>
</div>




<!-- <p-dialog header="Select Category to Filter" [(visible)]="display" modal="modal" showEffect="fade"
  [style]="{width: '550px'}" [contentStyle]="{height: '370px'}">

  <div class="p-fluid">
    <div class="p-grid" style="margin-bottom: 1rem">

      <div class="p-col-12" style="display: flex; gap: 3rem; margin-bottom: 1rem; ">

        <div>
          <p-dropdown id="region" [options]="regions" [(ngModel)]="tempRegion" placeholder="Select Region"
            optionValue="name" optionLabel="name" [style]="{width: '230px'}" (onChange)="onRegionChange()">
          </p-dropdown>
        </div>

        <div *ngIf="businessHubs.length">
          <p-dropdown id="businessHub" [options]="businessHubs" [(ngModel)]="tempBusinessHub"
            placeholder="Select Business Hub" optionValue="name" optionLabel="name" [style]="{width: '230px'}"
            (onChange)="onBusinessHubChange()">
          </p-dropdown>
        </div>

      </div>

      <div class="p-col-12" style="display: flex; gap: 3rem; margin-bottom: 1rem;">

        <div *ngIf="serviceCenters.length">
          <p-dropdown id="serviceCenter" [options]="serviceCenters" [(ngModel)]="tempServiceCenter"
            placeholder="Select Service Center" optionValue="name" optionLabel="name" [style]="{width: '230px'}">
          </p-dropdown>
        </div>

        <p-dropdown id="status" [options]="statuses" [(ngModel)]="tempStatus" placeholder="Select Status"
          optionValue="name" optionLabel="name" [style]="{width: '230px'}">
        </p-dropdown>
       
      </div>

      <div class="p-col-12" style="display: flex; gap: 3rem; margin-bottom: 1rem; ">

        <p-dropdown id="createdBy" [options]="createdBys" [(ngModel)]="tempCreatedBy" placeholder="Select CreatedBy"
          optionValue="name" optionLabel="name" [style]="{width: '230px'}">
        </p-dropdown>

        <p-dropdown id="updatedBy" [options]="updatedBys" [(ngModel)]="tempUpdatedBy" placeholder="Select UpdatedBy"
          optionValue="name" optionLabel="name" [style]="{width: '230px'}">
        </p-dropdown>

      </div>


      <div class="p-col-12" style="display: flex; gap: 3rem; margin-bottom: 1rem;">
        <p-calendar id="dateCreatedFrom" [(ngModel)]="tempDateCreatedFrom" placeholder="Start Date" appendTo="body"
          [style]="{width: '230px'}">
        </p-calendar>

        <p-calendar id="dateCreatedTo" [(ngModel)]="tempDateCreatedTo" placeholder="End Date" appendTo="body"
          [style]="{width: '230px'}">
        </p-calendar>
      </div>

      <div class="p-col-12" style="display: flex; gap: 3rem; margin-bottom: 1rem;">
        <p-calendar id="aplicationDate" [(ngModel)]="tempAplicationDates" placeholder="Application Date" appendTo="body"
          [style]="{width: '230px'}">
        </p-calendar>

        <p-dropdown id="approvedBy" [options]="approvedBys" [(ngModel)]="tempApproveBy" placeholder="Select ApprovedBy"
          optionValue="name" optionLabel="name" [style]="{width: '230px'}">
        </p-dropdown>
      </div>

    </div><br>

  
    <div class="p-grid p-justify-center">
      <button pButton type="button" label="Filter" (click)="onFilterButtonClick()">
      </button>
    </div>

  </div>
</p-dialog> -->
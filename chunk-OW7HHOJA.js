import{a as he}from"./chunk-NQFTFKYX.js";import{b as ve,c as we}from"./chunk-3BSAGVJI.js";import"./chunk-ST35GKEJ.js";import{b as Ce}from"./chunk-WXZQG76U.js";import{b as Se}from"./chunk-JK2WCNHE.js";import{m as de,q as fe}from"./chunk-B2LPOMVQ.js";import"./chunk-FJZWMPVK.js";import{b as ie}from"./chunk-EYNK32OA.js";import"./chunk-BL7XLXFW.js";import"./chunk-Y2TWHHJT.js";import{b as Y}from"./chunk-SDXV7PTX.js";import{a as _e}from"./chunk-FDQ6KAAT.js";import"./chunk-SXPLR5LF.js";import"./chunk-BUAUGQZJ.js";import{a as ge}from"./chunk-FIIS3JHD.js";import"./chunk-6YX36K4P.js";import{e as Z,f as oe,g as re,h as ne,i as me,j as ce,k as ue}from"./chunk-GKUFW2RI.js";import{a as te}from"./chunk-D6OM4TL4.js";import{c as pe}from"./chunk-UNZMK42Y.js";import"./chunk-VZKXXVR6.js";import"./chunk-LHYMOAVA.js";import{a as $}from"./chunk-HDDFEM7G.js";import{c as X,d as se,f as le,n as ae}from"./chunk-VTKS6MIP.js";import"./chunk-XVURSSVY.js";import"./chunk-KMIFLFRM.js";import"./chunk-5TMXRYYI.js";import{h as ee}from"./chunk-JSMWOMP6.js";import"./chunk-5Q75OANQ.js";import{$ as b,Ab as k,Ca as E,D as a,Da as R,Db as P,E as p,Ea as F,Fa as I,Fb as U,Ib as W,Lc as J,Mc as Q,Nb as G,Q as c,R as f,Ra as j,Ta as L,Tb as O,Ub as x,Vb as A,ba as S,cc as w,ha as r,hb as N,hc as z,ia as s,ib as B,ja as _,na as C,oa as h,pa as u,s as D,sc as H,tc as K,vc as q,x as y,xa as V,y as T,ya as l,za as g}from"./chunk-AWEHUNTX.js";import{a as M}from"./chunk-DM275RSA.js";function Me(n,v){if(n&1){let e=C();r(0,"div",9)(1,"a",10),h("click",function(){a(e);let t=u();return p(t.openSearch())}),_(2,"i",11),s(),r(3,"a",10),h("click",function(){a(e);let t=u();return p(t.reload())}),_(4,"i",12),s(),r(5,"span",13),_(6,"i",14),r(7,"input",15,1),F("ngModelChange",function(t){a(e);let o=u();return R(o.searchValue,t)||(o.searchValue=t),p(t)}),h("input",function(t){a(e);let o=u(),d=V(2);return p(o.onGlobalFilter(d,t))}),s()()()}if(n&2){let e=u();c(7),E("ngModel",e.searchValue)}}function De(n,v){n&1&&(r(0,"tr")(1,"th",16),l(2,"Customer No"),s(),r(3,"th",16),l(4,"Customer Name"),s(),r(5,"th",16),l(6,"Feeder"),s(),r(7,"th",16),l(8,"Status"),s(),r(9,"th",17),l(10,"Date Modified"),s(),r(11,"th",18),l(12,"Action"),s()())}function ye(n,v){if(n&1){let e=C();r(0,"tr",19)(1,"td"),l(2),s(),r(3,"td"),l(4),s(),r(5,"td"),l(6),s(),r(7,"td"),_(8,"p-tag",20),s(),r(9,"td"),l(10),j(11,"date"),s(),r(12,"td")(13,"button",21),h("click",function(){let t=a(e).$implicit,o=u();return p(o.viewDetails(t))}),s()()()}if(n&2){let e=v.$implicit,i=u();c(2),g(e.customer_no),c(2),g(e.customer_full_name),c(2),g(e.feeder),c(2),S("value",e.approval_status)("severity",i.getSeverity(e.approval_status)),c(2),g(L(11,6,e.last_modified,"MM/dd/yyyy"))}}function Te(n,v){n&1&&(r(0,"tr")(1,"td",22),l(2,"No records found."),s()())}var xe=(()=>{class n{constructor(e,i,t,o,d,m){this.authService=e,this.fb=i,this.customerService=t,this.router=o,this.loadingService=d,this.messageService=m,this.display=!1,this.filteredRecords=[],this.loading=!1,this.isFilterLoading=!1,this.isResetLoading=!1,this.currentPage=1,this.pageSize=20,this.isShowDetails=!1,this.uploadedFiles=[],this.searchValue="",this.errorLogs=[],this.uploading=!1,this.hasErrors=!1,this.showDetailsDialog=!1,this.exportLoading=!1,this.errorMessage="",this.selectedApprovedRecord=null,this.totalRecords=0,this.nodes=[],this.selectedNode=null,this.filterForm=this.fb.group({dateRange:[],feeder:[],businessUnit:[]})}ngOnInit(){this.reload()}reload(){this.loadCustomers(this.currentPage,this.pageSize)}openSearch(){this.showDetailsDialog=!0}filterApplied(e){this.filteredRecords=e?.results,this.totalRecords=e?.count}onClearFilters(){this.reload()}onDialogClosed(e){this.showDetailsDialog=e}handleNodeSelect(e){let i=e.node;i.data?.method&&i.data.method()}loadCustomers(e,i){this.loading=!0,this.customerService.getCustomersWithApprovedOrRejectedStatus(e,i).subscribe(t=>{this.filteredRecords=t.data?.results||[],this.loading=!1},t=>{console.error("Error fetching data:",t),this.loading=!1})}showDetails(e){this.selectedApprovedRecord=M({},e),console.log("Record details:",e)}viewDetails(e){this.router.navigate(["/app/customer-details",e.uid])}openDialog(){this.isShowDetails=!0,setTimeout(()=>{this.isShowDetails=!1,this.selectedApprovedRecord&&this.router.navigate(["/app/customer-details",this.selectedApprovedRecord.uid])},2e3)}closeDialog(){this.showDetailsDialog=!1}clear(e){e.clear()}navigateToDetails(){console.log("Navigating to details...")}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}getSeverity(e){switch(e){case"Approved":return"success";case"Rejected":return"danger";default:return"info"}}convertToCSV(e){let i=`Customer No,Customer Name,Feeder,Status,Date Captured,Date Modified
`,t=e.map(o=>{let d=o.date_created?new Date(o.date_created).toLocaleDateString("en-US"):"",m=o.last_modified?new Date(o.last_modified).toLocaleDateString("en-US"):"";return`${o.customer_no},${o.customer_full_name},${o.feeder},${o.approval_status},${d},${m}`}).join(`
`);return i+t}exportData(){this.exportLoading=!0,setTimeout(()=>{this.exportLoading=!1;let e=this.convertToCSV(this.filteredRecords),i=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),o=URL.createObjectURL(i);t.setAttribute("href",o),t.setAttribute("download","approved_assets.csv"),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},2e3)}static{this.\u0275fac=function(i){return new(i||n)(f($),f(O),f(_e),f(k),f(he),f(w))}}static{this.\u0275cmp=y({type:n,selectors:[["app-approved-asset"]],features:[I([w])],decls:8,vars:7,consts:[["dt1",""],["filter",""],[1,"card"],["scrollHeight","400px",3,"onRowSelect","value","loading","paginator","rows","scrollable"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"filterApplied","clearFiltersEvent","closeFiltersEvent","display","statusVisible"],[2,"display","flex","justify-content","flex-end","gap","20px"],[1,"p-button","p-button-outlined","font-bold","p-button-help","custom-button",3,"click"],[1,"pi","pi-filter"],[1,"pi","pi-refresh"],[1,"p-input-icon-left",2,"margin-left","20px"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Keyword Search",3,"ngModelChange","input","ngModel"],[2,"min-width","15rem"],[2,"min-width","10rem"],[2,"min-width","6rem"],[1,"cursor-pointer"],[3,"value","severity"],["pButton","","icon","pi pi-eye",1,"p-button-text",3,"click"],["colspan","6"]],template:function(i,t){if(i&1){let o=C();r(0,"div",2)(1,"p-table",3,0),h("onRowSelect",function(m){return a(o),p(t.showDetails(m.data))}),b(3,Me,9,1,"ng-template",4)(4,De,13,0,"ng-template",5)(5,ye,14,9,"ng-template",6)(6,Te,3,0,"ng-template",7),s(),r(7,"app-filter",8),h("filterApplied",function(m){return a(o),p(t.filterApplied(m))})("clearFiltersEvent",function(){return a(o),p(t.onClearFilters())})("closeFiltersEvent",function(m){return a(o),p(t.onDialogClosed(m))}),s()()}i&2&&(c(),S("value",t.filteredRecords)("loading",t.loading)("paginator",!0)("rows",100)("scrollable",!0),c(6),S("display",t.showDetailsDialog)("statusVisible",!0))},dependencies:[le,z,K,J,me,U,W,G,ve,N]})}}return n})();var be=[{path:"",component:xe}],gt=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=T({type:n})}static{this.\u0275inj=D({imports:[B,ae,X,Y,q,Ce,de,Q,fe,ge,H,oe,ie,ee,Se,te,pe,ne,re,Z,se,A,x,ce,ue,P.forChild(be),A,x,we]})}}return n})();export{gt as ApprovedAssetModule,be as approvedAssetRoutes};

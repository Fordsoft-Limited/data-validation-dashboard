import{a as G}from"./chunk-FSDIJ6OC.js";import{b as ee,c as te}from"./chunk-AKFQWX6T.js";import{a as $}from"./chunk-CNB447IW.js";import{b as W}from"./chunk-FJZWMPVK.js";import{a as X,b as Y,c as Z}from"./chunk-BUAUGQZJ.js";import"./chunk-D6OM4TL4.js";import"./chunk-VZKXXVR6.js";import"./chunk-QHGNCM4W.js";import{a as D}from"./chunk-HDDFEM7G.js";import"./chunk-XVURSSVY.js";import"./chunk-KMIFLFRM.js";import"./chunk-5Q75OANQ.js";import{$ as u,Aa as F,Db as T,Fa as E,Fb as j,Gb as p,Ia as k,Ib as q,Jb as U,Lc as J,Mc as K,Ob as V,Q as a,Qb as O,R as c,Rb as A,Tb as R,Vb as B,ba as d,cc as Q,db as I,ea as C,ha as n,ia as t,ib as N,ic as L,ja as m,oa as h,pa as w,s as b,tc as z,ua as P,va as M,vc as H,wa as _,x as v,y as S,ya as l,za as y}from"./chunk-AWEHUNTX.js";import"./chunk-DM275RSA.js";var oe=["fileInput"],ne=()=>({"background-color":"transparent"});function ae(r,g){r&1&&(n(0,"small",27),l(1," Current Password is required and must be at least 6 characters. "),t())}function se(r,g){r&1&&(n(0,"small",27),l(1," New Password is required and must be at least 6 characters. "),t())}function le(r,g){r&1&&(n(0,"small",27),l(1," Passwords do not match. "),t())}function de(r,g){if(r&1&&(n(0,"div",28)(1,"p"),m(2,"i",29),l(3),t()()),r&2){let o=w();a(3),y(o.backendsuccessMessage)}}function me(r,g){if(r&1&&(n(0,"div",30)(1,"p"),m(2,"i",31),l(3),t()()),r&2){let o=w();a(3),F(" ",o.backendErrorMessage,"")}}var re=(()=>{class r{constructor(o,e,i,s){this.fb=o,this.userService=e,this.snackbarService=i,this.authService=s,this.imageUrl=null,this.selectedFile=null,this.backendErrorMessage=null,this.backendsuccessMessage=null,this.passwordChanged=!1,this.hasErrors=!1,this.errorMessage="",this.loading=!1,this.userAddedError=!1,this.profileForm=this.fb.group({name:["",p.required],email:["",[p.required,p.email]],phone:["",p.required]}),this.passwordForm=this.fb.group({currentPassword:["",[p.required,p.minLength(6)]],newPassword:["",[p.required,p.minLength(6)]],confirmPassword:["",[p.required]]},{validator:this.passwordsMatchValidator})}passwordsMatchValidator(o){return o.get("newPassword")?.value===o.get("confirmPassword")?.value?null:{mismatch:!0}}handlePasswordChange(){if(this.loading=!0,this.passwordForm.valid){let o={old_password:this.passwordForm.get("currentPassword")?.value,new_password:this.passwordForm.get("newPassword")?.value};this.userService.changePassword(o).subscribe({next:e=>{console.log("Password change response",e),e.status==="Success"?(this.backendsuccessMessage="Password changed successfully!",this.backendErrorMessage=null,this.passwordChanged=!0,this.passwordForm.reset(),setTimeout(()=>{this.passwordChanged=!1},4e3)):this.backendErrorMessage="Failed to change password. Please try again."},error:e=>{console.error("Error changing password",e),e.error&&e.error.errorMessage?this.backendErrorMessage=e.error.errorMessage:this.backendErrorMessage="Failed to change password. Please try again.",this.passwordChanged=!1,setTimeout(()=>{this.backendErrorMessage=null},4e3)}})}else this.passwordForm.markAllAsTouched()}onImageSelect(o){let e=o.files[0];this.selectedFile=e;let i=new FileReader;i.onload=s=>{this.imageUrl=s.target?.result??null},i.readAsDataURL(e)}onUpload(o){if(!this.selectedFile){console.log("No file selected");return}let e=new FormData;e.append("file",this.selectedFile,this.selectedFile.name),console.log("Form Data:",e),this.cancelUpload()}onSubmit(){if(this.profileForm.valid){let o=this.profileForm.value;console.log("Profile Data:",o)}}cancelUpload(){this.selectedFile=null,this.imageUrl=null,this.fileInput&&(this.fileInput.nativeElement.value="")}static{this.\u0275fac=function(e){return new(e||r)(c(R),c($),c(G),c(D))}}static{this.\u0275cmp=v({type:r,selectors:[["app-settings"]],viewQuery:function(e,i){if(e&1&&P(oe,5),e&2){let s;M(s=_())&&(i.fileInput=s.first)}},features:[E([Q])],decls:45,vars:14,consts:[[1,"grid"],[1,"col-12","mt-2"],[1,"col-12","-mt-4"],["header","Profile","leftIcon","pi pi-user"],[1,"settings-container"],[1,"profile-content"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["id","name","type","text","pInputText","","placeholder","Enter your name","formControlName","name",1,"input-text"],["for","email"],["id","email","type","email","pInputText","","placeholder","Enter your email","formControlName","email",1,"input-text"],["for","phone"],["id","phone","type","tel","pInputText","","placeholder","Enter your phone number","formControlName","phone",1,"input-text"],["pButton","","label","Save Changes","icon","pi pi-check",1,"p-button-success"],["header","Change Password","leftIcon","pi pi-sync"],[1,"settings-container","mt-4"],[1,"max-w-19rem"],[1,"form-group","flex","flex-column","gap-2"],["for",""],["formControlName","currentPassword",1,"w-full","custom-password",3,"toggleMask","feedback"],["class","p-error",4,"ngIf"],["formControlName","newPassword",1,"w-full","custom-password",3,"toggleMask"],["formControlName","confirmPassword",1,"w-full","custom-password",3,"toggleMask"],["pButton","","label","Change Password","type","submit",1,"p-button","w-full"],["class","text-center","style","border: 1px solid #218838; background-color: #28a745; color: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;",4,"ngIf"],["class","text-center","style","border: 1px solid #c82333; background-color: #dc3545; margin-top: 20px; color: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;",4,"ngIf"],[1,"p-error"],[1,"text-center",2,"border","1px solid #218838","background-color","#28a745","color","white","padding","10px","border-radius","5px","margin-bottom","10px"],[1,"pi","pi-check-circle",2,"margin-right","5px"],[1,"text-center",2,"border","1px solid #c82333","background-color","#dc3545","margin-top","20px","color","white","padding","10px","border-radius","5px","margin-bottom","10px"],[1,"pi","pi-exclamation-triangle",2,"margin-right","5px"]],template:function(e,i){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"h3"),l(3,"Account Settings"),t()(),n(4,"div",2)(5,"p-tabView")(6,"p-tabPanel",3)(7,"div",4)(8,"div",5)(9,"form",6),h("ngSubmit",function(){return i.onSubmit()}),n(10,"div",7)(11,"label",8),l(12,"Name"),t(),m(13,"input",9),t(),n(14,"div",7)(15,"label",10),l(16,"Email"),t(),m(17,"input",11),t(),n(18,"div",7)(19,"label",12),l(20,"Phone Number"),t(),m(21,"input",13),t(),m(22,"button",14),t()()()(),n(23,"p-tabPanel",15)(24,"div",16)(25,"div",17)(26,"form",6),h("ngSubmit",function(){return i.handlePasswordChange()}),n(27,"div",18)(28,"label",19),l(29,"Current Password"),t(),m(30,"p-password",20),u(31,ae,2,0,"small",21),t(),n(32,"div",18)(33,"label",19),l(34,"New Password"),t(),m(35,"p-password",22),u(36,se,2,0,"small",21),t(),n(37,"div",18)(38,"label",19),l(39,"Confirm New Password"),t(),m(40,"p-password",23),u(41,le,2,0,"small",21),t(),m(42,"button",24),t(),u(43,de,4,1,"div",25)(44,me,4,1,"div",26),t()()()()()()),e&2){let s,f,x;a(5),C(k(13,ne)),a(4),d("formGroup",i.profileForm),a(17),d("formGroup",i.passwordForm),a(4),d("toggleMask",!0)("feedback",!1),a(),d("ngIf",((s=i.passwordForm.get("currentPassword"))==null?null:s.touched)&&((s=i.passwordForm.get("currentPassword"))==null?null:s.invalid)),a(4),d("toggleMask",!0),a(),d("ngIf",((f=i.passwordForm.get("newPassword"))==null?null:f.touched)&&((f=i.passwordForm.get("newPassword"))==null?null:f.invalid)),a(4),d("toggleMask",!0),a(),d("ngIf",(i.passwordForm.errors==null?null:i.passwordForm.errors.mismatch)&&((x=i.passwordForm.get("confirmPassword"))==null?null:x.touched)),a(2),d("ngIf",i.passwordChanged),a(),d("ngIf",i.backendErrorMessage)}},dependencies:[I,Y,X,z,J,V,j,q,U,O,A,ee],styles:[".p-tabview .p-tabview-nav-link{padding-right:40px}[_nghost-%COMP%]     .custom-password{width:100%!important;max-width:50rem!important;height:50px!important;font-size:16px!important}.image-container[_ngcontent-%COMP%]{width:100px;height:100px;border:1px solid #c1c1c1;border-radius:50%;margin-bottom:5px;display:flex;justify-content:center;align-items:center;background-color:#645c4a4d}.settings-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:20px}.image-upload-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:10px;margin-bottom:20px}.image-preview[_ngcontent-%COMP%]{width:100px;height:100px}.profile-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%;border:1px solid #000}.form-group[_ngcontent-%COMP%]{margin-bottom:15px;width:100%;max-width:400px}.input-text[_ngcontent-%COMP%]{width:100%;height:40px;padding:8px;margin-top:5px;box-sizing:border-box}"]})}}return r})();var pe=[{path:"",component:re}],je=(()=>{class r{static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275mod=S({type:r})}static{this.\u0275inj=b({imports:[N,L,Z,W,H,K,B,te,T.forChild(pe)]})}}return r})();export{je as SettingsModule,pe as settingsRoutes};

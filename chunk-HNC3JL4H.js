import{a as U}from"./chunk-J2QXRKIG.js";import{a as Ke,b as Xe}from"./chunk-DFYT2OQB.js";import{a as Ge,b as Ye,c as Ze}from"./chunk-X22465MG.js";import"./chunk-PSUU27KI.js";import{a as Je,b as Qe}from"./chunk-WXZQG76U.js";import{a as qe,b as ze}from"./chunk-JK2WCNHE.js";import{b as ve,q as K}from"./chunk-B2LPOMVQ.js";import"./chunk-FJZWMPVK.js";import{a as xe,b as Te}from"./chunk-EYNK32OA.js";import"./chunk-BL7XLXFW.js";import"./chunk-Y2TWHHJT.js";import{b as Se}from"./chunk-SDXV7PTX.js";import{a as H}from"./chunk-ZUNNH25A.js";import"./chunk-SXPLR5LF.js";import"./chunk-BUAUGQZJ.js";import{a as Ue}from"./chunk-FIIS3JHD.js";import"./chunk-6YX36K4P.js";import{d as we,e as De,f as Ne,g as Ve,h as Ie,i as Oe,j as We,k as He}from"./chunk-GKUFW2RI.js";import{a as Re}from"./chunk-D6OM4TL4.js";import{b as Be,c as Le}from"./chunk-UNZMK42Y.js";import"./chunk-VZKXXVR6.js";import"./chunk-NG4D23UF.js";import{a as ue}from"./chunk-HDDFEM7G.js";import{d as ke,f as W,g as Ee,h as Pe,l as Fe,m as je,n as Ae}from"./chunk-VTKS6MIP.js";import"./chunk-XVURSSVY.js";import"./chunk-KMIFLFRM.js";import"./chunk-5TMXRYYI.js";import{h as Me}from"./chunk-JSMWOMP6.js";import"./chunk-5Q75OANQ.js";import{$ as v,Aa as M,Ab as j,Ca as b,D as d,Da as S,Db as me,E as m,Ea as w,Fa as k,Fb as A,Ia as D,Ib as B,Ja as q,Lc as ye,Mc as be,Nb as L,O as ie,Q as s,R as _,Ra as E,Sb as pe,Ta as P,Tb as fe,Ub as J,Vb as Q,_b as x,ba as p,bb as se,cb as le,cc as T,db as ce,ea as N,ha as n,hb as F,hc as O,ia as r,ib as z,ja as C,na as R,oa as g,pa as h,r as $,s as ee,sc as ge,tc as he,ua as re,uc as _e,va as oe,vc as Ce,wa as ne,x as I,xa as ae,y as te,ya as c,yb as de,za as y}from"./chunk-AWEHUNTX.js";import{a as Z}from"./chunk-DM275RSA.js";var mt=["filter"],ut=()=>[10,25,50],pt=()=>["feeder","meterNo","date","status"];function ft(o,f){if(o&1){let e=R();n(0,"div",9)(1,"p-button",10),g("click",function(){d(e);let t=h();return m(t.navigateToDetails())}),r(),n(2,"div",11)(3,"a",12),g("click",function(){d(e);let t=h();return m(t.openSearch())}),C(4,"i",13),r(),n(5,"a",12),g("click",function(){d(e);let t=h();return m(t.reload())}),C(6,"i",14),r(),n(7,"span",15),C(8,"i",16),n(9,"input",17,1),w("ngModelChange",function(t){d(e);let l=h();return S(l.searchValue,t)||(l.searchValue=t),m(t)}),g("input",function(t){d(e);let l=h(),u=ae(2);return m(l.onGlobalFilter(u,t))}),r()()()()}if(o&2){let e=h();s(),p("loading",e.loading)("disabled",e.selectedCustomers.length===0),s(8),b("ngModel",e.searchValue)}}function gt(o,f){o&1&&(n(0,"tr")(1,"th",18),C(2,"p-tableHeaderCheckbox"),r(),n(3,"th",19)(4,"div",20),c(5," Customer No "),r()(),n(6,"th",19)(7,"div",20),c(8," Feeder "),r()(),n(9,"th",19)(10,"div",20),c(11," Meter No "),r()(),n(12,"th",21)(13,"div",20),c(14," Date "),r()(),n(15,"th",21)(16,"div",20),c(17," Status "),r()()())}function ht(o,f){if(o&1&&(n(0,"tr",22)(1,"td"),C(2,"p-tableCheckbox",23),r(),n(3,"td"),c(4),r(),n(5,"td"),c(6),r(),n(7,"td"),c(8),r(),n(9,"td"),c(10),E(11,"date"),r(),n(12,"td"),C(13,"p-tag",24),r()()),o&2){let e=f.$implicit,i=h();s(2),p("value",e),s(2),M(" ",e.customer_no," "),s(2),M(" ",e.feeder," "),s(2),M(" ",e.meter_no," "),s(2),M(" ",P(11,7,e.date_created,"MM/dd/yyyy")," "),s(3),p("value",e.approval_status)("severity",i.getSeverity(e.approval_status))}}function _t(o,f){o&1&&(n(0,"tr")(1,"td",25),c(2,"No customers found."),r()())}var $e=(()=>{class o{constructor(e,i,t,l){this.customerService=e,this.fb=i,this.router=t,this.utilService=l,this.filteredCustomers=[],this.selectedCustomers=[],this.regions=[],this.businessUnits=[],this.feeders=[],this.loading=!1,this.searchValue="",this.showDetailsDialog=!1,this.selectedCustomer=null,this.comments="",this.errorMessage="",this.currentPage=1,this.pageSize=20,this.isResetLoading=!1,this.filteredNewCustomers=[],this.totalRecords=0,this.filterForm=this.fb.group({dateRange:[],feeder:[],businessUnit:[]})}ngOnInit(){this.initializeForm(),this.reload()}reload(){this.loadCustomers(this.currentPage,this.pageSize)}initializeForm(){this.filterForm=this.fb.group({region:[null],businessUnit:[null],feeder:[null],dateCreatedFrom:[null],dateCreatedTo:[null]}),this.regions=Ge.map(e=>({label:e.name,value:e}))}onRegionChange(e){let i=e.value;this.updateBusinessUnits(i),this.filterForm.get("businessUnit")?.reset(),this.filterForm.get("feeder")?.reset()}onBusinessHubChange(e){let i=e.value;this.updateFeeders(i),this.filterForm.get("feeder")?.reset()}updateBusinessUnits(e){this.businessUnits=e.businessHubs.map(i=>({label:i.name,value:i}))}updateFeeders(e){e&&e.serviceCentres?this.feeders=e.serviceCentres.map(i=>({label:i.name,value:i})):this.feeders=[]}openSearch(){this.showDetailsDialog=!0}filterApplied(e){console.log(e),this.filteredNewCustomers=e?.results,this.totalRecords=e?.count}onClearFilters(){this.reload()}onDialogClosed(e){this.showDetailsDialog=e}resetFilter(){this.isResetLoading=!0,setTimeout(()=>{this.isResetLoading=!1,this.filterForm.reset(),this.filteredCustomers=[...this.customers]},2e3)}loadCustomers(e,i){this.loading=!0,this.customerService.getCustomerStatusByReViewed(e,i).subscribe(t=>{console.log("Data loaded:",t),this.customers=t.data?.results||[],this.filteredCustomers=[...this.customers],this.loading=!1},t=>{console.error("Error loading customers:",t),this.errorMessage="Failed to load customers. Please try again later.",this.loading=!1})}applyStatusFilter(){this.filteredCustomers=this.customers.filter(e=>e.aproval_status==="Awaiting Review")}filterData(){this.loading=!0;let{dateCreatedFrom:e,dateCreatedTo:i,feeder:t,businessUnit:l,region:u}=this.filterForm.value,a=u?u.name:null,G=l?l.name:null,Y=t?t.name:null;this.customerService.getNewCustomerFilter(a,G,Y,e,i).subscribe(V=>{console.log("Filtered customers:",V),this.customers=V.data?.results||[],this.filteredCustomers=[...this.customers],this.loading=!1},V=>{console.error("Error loading customers:",V),this.errorMessage="Failed to load customers. Please try again later.",this.loading=!1})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}showDetails(e){this.selectedCustomer=Z({},e)}navigateToDetails(){let e=this.selectedCustomers[0].uid;this.utilService.saveItems(this.selectedCustomers),this.router.navigate(["app/data-validation/data-verification/"+e])}viewDetails(e){this.router.navigate(["/app/customer-details",e.uid])}openDialog(){this.selectedCustomer&&(this.showDetailsDialog=!0)}rejectRecord(){this.selectedCustomer&&(this.selectedCustomer.status="Rejected",this.selectedCustomer.comments=this.comments)}closeDialog(){this.showDetailsDialog=!1}getSeverity(e){switch(e){case"Approved":return"success";case"Awaiting review":return"warning";case"Rejected":return"danger";default:return"info"}}static{this.\u0275fac=function(i){return new(i||o)(_(H),_(fe),_(j),_(U))}}static{this.\u0275cmp=I({type:o,selectors:[["app-data-validation"]],viewQuery:function(i,t){if(i&1&&re(mt,5),i&2){let l;oe(l=ne())&&(t.filter=l.first)}},features:[k([T,x])],decls:8,vars:11,consts:[["dt1",""],["filter",""],[1,"card"],["dataKey","uid","scrollHeight","400px",3,"selectionChange","onRowSelect","value","selection","rows","rowsPerPageOptions","loading","paginator","globalFilterFields","scrollable"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"filterApplied","clearFiltersEvent","closeFiltersEvent","display"],[1,"flex",2,"display","flex","justify-content","space-between"],["label","Review",1,"ml-3",3,"click","loading","disabled"],[2,"display","flex","justify-content","flex-end","gap","20px"],[1,"p-button","p-button-outlined","font-bold","p-button-help","custom-button",3,"click"],[1,"pi","pi-filter"],[1,"pi","pi-refresh"],[1,"p-input-icon-left",2,"margin-left","20px"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Keyword Search",3,"ngModelChange","input","ngModel"],[2,"width","4rem"],[2,"min-width","15rem"],[1,"flex","align-items-center"],[2,"min-width","10rem"],[1,"cursor-pointer"],[3,"value"],[3,"value","severity"],["colspan","7"]],template:function(i,t){if(i&1){let l=R();n(0,"div",2)(1,"p-table",3,0),w("selectionChange",function(a){return d(l),S(t.selectedCustomers,a)||(t.selectedCustomers=a),m(a)}),g("onRowSelect",function(a){return d(l),m(t.showDetails(a.data))}),v(3,ft,11,3,"ng-template",4)(4,gt,18,0,"ng-template",5)(5,ht,14,10,"ng-template",6)(6,_t,3,0,"ng-template",7),r(),n(7,"app-filter",8),g("filterApplied",function(a){return d(l),m(t.filterApplied(a))})("clearFiltersEvent",function(){return d(l),m(t.onClearFilters())})("closeFiltersEvent",function(a){return d(l),m(t.onDialogClosed(a))}),r()()}i&2&&(s(),p("value",t.filteredCustomers),b("selection",t.selectedCustomers),p("rows",100)("rowsPerPageOptions",D(9,ut))("loading",t.loading)("paginator",!0)("globalFilterFields",D(10,pt))("scrollable",!0),s(6),p("display",t.showDetailsDialog))},dependencies:[O,_e,Oe,ye,A,B,L,W,Fe,je,Ye,F],styles:[".bulk-approval-container[_ngcontent-%COMP%]{padding:20px}.action-buttons[_ngcontent-%COMP%]{margin-bottom:10px}p-table[_ngcontent-%COMP%]{margin-top:20px}.custom-spinner[_ngcontent-%COMP%]{margin:20px auto;display:block;width:50px;height:50px}.flex[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.flex-column[_ngcontent-%COMP%]{flex-direction:column}.gap-2[_ngcontent-%COMP%]{gap:8px}"]})}}return o})();var et=(()=>{class o{getDataValidation(){return[{id:"1001",customerFullName:"John Doe",accountNo:"ACC001",meterNo:"MTR001",address:"123 Elm St",city:"Springfield",lga:"LGA1",state:"State1",nearestLandmark:"Near the park",date:new Date("2024-09-27"),latitude:"12.345678",longitude:"98.765432",customerId:"CUST001",cin:"CIN001",applicationDate:"2024-01-15",mobile:"1234567890",email:"johndoe@example.com",statusCode:"Active",accountType:"Postpaid",currentTariffCode:"R1",correctTariffCode:"R1",tariffClass:"LFN",feeder:"Feeder1",feederId:"FEED001",serviceCenter:"Center1",distributionName:"Distribution1",dssId:"DSS001",ltPoleId:"LT001",serviceWire:"Wire1",upriser:"Upriser1",region:"Region1",businessHub:"Hub1",accountCategory:"Residential",connectionType:"Metered",custNatureOfBusiness:"Business",customerNIN:"NIN001",customerSupplyType:"1-Phase",customerEstimatedLoad:"1000",custHasMeter:"Yes",customerMeterCategory:"Postpaid - Electronics",customerMeterManufacturer:"Manufacturer1",customerMeterSaled:"Yes",customerMeterAccessible:"Yes",customerMeterLocation:"Indoor",customerBillName:"John Doe",customerHasAccountNo:"Yes",customerGroup:"New",isLandlord:"No",landlordName:"",landlordPhone:"",tenantName:"",tenantPhone:"",meterCTRatio:"1:1",status:"Pending",supplyType:"Single Phase"},{id:"1002",customerFullName:"Jane Smith",accountNo:"ACC002",meterNo:"MTR002",address:"456 Oak St",city:"Metropolis",lga:"LGA2",state:"State2",nearestLandmark:"Near the library",date:new Date("2024-09-27"),latitude:"13.456789",longitude:"97.654321",customerId:"CUST002",cin:"CIN002",applicationDate:"2024-02-15",mobile:"2345678901",email:"janesmith@example.com",statusCode:"Suspended",accountType:"Prepaid",currentTariffCode:"R2",correctTariffCode:"R2",tariffClass:"NMD",feeder:"Feeder2",feederId:"FEED002",serviceCenter:"Center2",distributionName:"Distribution2",dssId:"DSS002",ltPoleId:"LT002",serviceWire:"Wire2",upriser:"Upriser2",region:"Region2",businessHub:"Hub2",accountCategory:"Commercial",connectionType:"Un-Metered",custNatureOfBusiness:"Retail",customerNIN:"NIN002",customerSupplyType:"3-Phase",customerEstimatedLoad:"2000",custHasMeter:"No",customerMeterCategory:"Prepaid - Pole-Mounted",customerMeterManufacturer:"Manufacturer2",customerMeterSaled:"No",customerMeterAccessible:"No",customerMeterLocation:"Outdoor",customerBillName:"Jane Smith",customerHasAccountNo:"No",customerGroup:"Existing",isLandlord:"Yes",landlordName:"Robert Smith",landlordPhone:"321-654-0987",tenantName:"Emily Smith",tenantPhone:"234-567-8902",meterCTRatio:"1:1",status:"Approved",supplyType:"Three Phase"},{id:"1003",customerFullName:"Alice Johnson",accountNo:"ACC003",meterNo:"MTR003",address:"789 Pine St",city:"Gotham",lga:"LGA3",state:"State3",nearestLandmark:"Near the school",date:new Date("2024-09-27"),latitude:"14.567890",longitude:"96.543210",customerId:"CUST003",cin:"CIN003",applicationDate:"2024-03-15",mobile:"3456789012",email:"alicejohnson@example.com",statusCode:"Closed",accountType:"Postpaid",currentTariffCode:"R3",correctTariffCode:"R3",tariffClass:"MD1",feeder:"Feeder3",feederId:"FEED003",serviceCenter:"Center3",distributionName:"Distribution3",dssId:"DSS003",ltPoleId:"LT003",serviceWire:"Wire3",upriser:"Upriser3",region:"Region3",businessHub:"Hub3",accountCategory:"Residential",connectionType:"Metered",custNatureOfBusiness:"Service",customerNIN:"NIN003",customerSupplyType:"1-Phase",customerEstimatedLoad:"1500",custHasMeter:"Yes",customerMeterCategory:"Postpaid - Digital",customerMeterManufacturer:"Manufacturer3",customerMeterSaled:"Yes",customerMeterAccessible:"Yes",customerMeterLocation:"Indoor",customerBillName:"Alice Johnson",customerHasAccountNo:"Yes",customerGroup:"New",isLandlord:"No",landlordName:"",landlordPhone:"",tenantName:"",tenantPhone:"",meterCTRatio:"1:1",status:"Rejected",supplyType:"Single Phase"},{id:"1004",customerFullName:"Bob Brown",accountNo:"ACC004",meterNo:"MTR004",address:"321 Birch St",city:"Star City",lga:"LGA4",state:"State4",nearestLandmark:"Near the mall",latitude:"15.678901",longitude:"95.432109",customerId:"CUST004",cin:"CIN004",applicationDate:"2024-04-15",mobile:"4567890123",email:"bobbrown@example.com",statusCode:"Inactive",accountType:"Prepaid",currentTariffCode:"C1",correctTariffCode:"C1",tariffClass:"MD2",feeder:"Feeder4",feederId:"FEED004",serviceCenter:"Center4",distributionName:"Distribution4",dssId:"DSS004",ltPoleId:"LT004",serviceWire:"Wire4",upriser:"Upriser4",region:"Region4",businessHub:"Hub4",accountCategory:"Commercial",connectionType:"Un-Metered",custNatureOfBusiness:"Wholesale",customerNIN:"NIN004",customerSupplyType:"3-Phase",customerEstimatedLoad:"2500",custHasMeter:"No",customerMeterCategory:"Prepaid - Wall-mounted",customerMeterManufacturer:"Manufacturer4",customerMeterSaled:"No",customerMeterAccessible:"No",customerMeterLocation:"Outdoor",customerBillName:"Bob Brown",customerHasAccountNo:"Yes",customerGroup:"Existing",isLandlord:"Yes",landlordName:"Susan Brown",landlordPhone:"654-321-0987",tenantName:"Mike Brown",tenantPhone:"567-890-1234",meterCTRatio:"1:1",date:new Date("2024-09-25"),status:"Pending",supplyType:"Single Phase"},{id:"1005",customerFullName:"Charlie Davis",accountNo:"ACC005",meterNo:"MTR005",address:"654 Cedar St",city:"Central City",lga:"LGA5",state:"State5",nearestLandmark:"Near the post office",latitude:"16.789012",longitude:"94.321098",customerId:"CUST005",cin:"CIN005",applicationDate:"2024-05-15",mobile:"5678901234",email:"charliedavis@example.com",statusCode:"Active",accountType:"Postpaid",currentTariffCode:"R4",correctTariffCode:"R4",tariffClass:"LFN",feeder:"Feeder5",feederId:"FEED005",serviceCenter:"Center5",distributionName:"Distribution5",dssId:"DSS005",ltPoleId:"LT005",serviceWire:"Wire5",upriser:"Upriser5",region:"Region5",businessHub:"Hub5",accountCategory:"Residential",connectionType:"Metered",custNatureOfBusiness:"Home",customerNIN:"NIN005",customerSupplyType:"1-Phase",customerEstimatedLoad:"1200",custHasMeter:"Yes",customerMeterCategory:"Postpaid - Mechanical",customerMeterManufacturer:"Manufacturer5",customerMeterSaled:"Yes",customerMeterAccessible:"Yes",customerMeterLocation:"Indoor",customerBillName:"Charlie Davis",customerHasAccountNo:"Yes",customerGroup:"New",isLandlord:"No",landlordName:"",landlordPhone:"",tenantName:"",tenantPhone:"",meterCTRatio:"1:1",date:new Date("2024-09-24"),status:"Pending",supplyType:"Single Phase"}]}getValidation(){return Promise.resolve(this.getDataValidation())}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=$({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var vt=()=>["customer_no"],yt=()=>({width:"50rem"}),tt=()=>({width:"30rem"}),bt=o=>({"active-row":o}),St=o=>({"background-color":o});function wt(o,f){o&1&&(n(0,"tr")(1,"th",38),c(2,"Customer No "),C(3,"p-sortIcon",39),r()())}function Dt(o,f){if(o&1){let e=R();n(0,"tr",40),g("click",function(){let t=d(e).$implicit,l=h();return m(l.onSelectedRecordChange(t))}),n(1,"td"),c(2),r()()}if(o&2){let e=f.$implicit,i=f.rowIndex,t=h();p("ngClass",q(2,bt,i===t.currentIndex)),s(2),y(e.customer_no)}}function Mt(o,f){if(o&1&&(n(0,"span",41),C(1,"i",42),r()),o&2){let e=f.$implicit;N(q(2,St,e.status==="Rejected"?"#ff0000":"#00ff00"))}}function Rt(o,f){if(o&1&&(n(0,"div",43)(1,"p",44)(2,"b"),c(3,"Category: "),r(),c(4),r(),n(5,"p",44)(6,"b"),c(7,"Status: "),r(),c(8),r(),n(9,"p",44)(10,"b"),c(11,"Description: "),r(),c(12),r(),n(13,"p",44)(14,"b"),c(15,"Posted by: "),r(),c(16),r(),n(17,"p",44)(18,"b"),c(19,"Date: "),r(),c(20),E(21,"date"),r()()),o&2){let e=f.$implicit;s(4),y(e.category),s(4),y(e.status),s(4),y(e.description),s(4),y(e.posted_by.name),s(4),y(P(21,5,e.event_date,"MM/dd/yyyy HH:mm"))}}function xt(o,f){if(o&1&&(n(0,"div",53)(1,"span"),c(2),r()()),o&2){let e=h().$implicit,i=h(2);s(2),y(i.currentRecord.newData[e.key]||"----")}}function Tt(o,f){if(o&1&&(n(0,"div",54)(1,"span"),c(2),r()()),o&2){let e=h().$implicit,i=h(2);s(2),y(i.currentRecord.oldData[e.key]||"----")}}function Nt(o,f){if(o&1&&(n(0,"div",50)(1,"label"),c(2),r(),v(3,xt,3,1,"div",51)(4,Tt,3,1,"div",52),r()),o&2){let e=f.$implicit,i=h(2);s(2),y(e.name),s(),p("ngIf",i.currentRecord.newData),s(),p("ngIf",i.currentRecord==null?null:i.currentRecord.oldData)}}function Vt(o,f){if(o&1&&(n(0,"div",55),C(1,"img",56),r()),o&2){let e=h(2);s(),p("src",e.qrCode,ie)}}function It(o,f){if(o&1&&(n(0,"div",45)(1,"div",46),v(2,Nt,5,3,"div",47),n(3,"div",48),v(4,Vt,2,1,"div",49),r()()()),o&2){let e=h();s(2),p("ngForOf",e.customerFields),s(2),p("ngIf",e.qrCode)}}function kt(o,f){o&1&&(n(0,"small",57),c(1,"Rejection reason is required."),r())}function Et(o,f){o&1&&(n(0,"small",57),c(1,"Approval reason is required."),r())}var it=(()=>{class o{constructor(e,i,t,l,u,a,G,Y){this.router=e,this.dataValidationService=i,this.confirmationService=t,this.messageService=l,this.customerService=u,this.authService=a,this.utilService=G,this.activatedRoute=Y,this.selectedRecords=[],this.qrCode=null,this.currentIndex=0,this.events=null,this.comments=" Well done ",this.rejectDialog=!1,this.reviewDialog=!1,this.approveDialog=!1,this.approveReason="",this.rejectReason="",this.statusCodes=[],this.accountTypes=[],this.supplyTypes=[],this.currentTariffCode=[],this.tariffCode=[],this.correctTariffCode=[],this.customerHasMeter=[],this.accountCategory=[],this.connectionType=[],this.customerMeterCategory=[],this.meterLocation=[],this.customerMeterAccessible=[],this.customerMeterSealed=[],this.customerHasAccountNo=[],this.customerGroup=[],this.isLandlord=[],this.customerFields=[{name:"Customer Full Name",key:"customer_full_name"},{name:"Customer ID",key:"customer_id"},{name:"Account Number",key:"account_no"},{name:"Meter Number",key:"meter_no"},{name:"Address",key:"address"},{name:"City",key:"city"},{name:"LGA",key:"lga"},{name:"State",key:"state"},{name:"Nearest Landmark",key:"nearest_landmark"},{name:"Setup Date",key:"setup_date"},{name:"Application Date",key:"application_date"},{name:"Latitude",key:"latitude"},{name:"Longitude",key:"longitude"},{name:"CIN",key:"cin"},{name:"Mobile Number",key:"mobile"},{name:"Email",key:"email"},{name:"Status Code",key:"status_code"},{name:"Account Type",key:"account_type"},{name:"Current Tariff Code",key:"current_tariff_code"},{name:"Correct Tariff Code",key:"correct_tariff_code"},{name:"Tariff Class",key:"tariff_class"},{name:"Feeder",key:"feeder"},{name:"Feeder ID",key:"feeder_id"},{name:"Service Center",key:"service_center"},{name:"Distribution Name",key:"distribution_name"},{name:"DSS ID",key:"dss_id"},{name:"LT Pole ID",key:"lt_pole_id"},{name:"Service Wire",key:"service_wire"},{name:"Upriser",key:"upriser"},{name:"Region",key:"region"},{name:"Business Hub",key:"business_hub"},{name:"Account Category",key:"account_category"},{name:"Connection Type",key:"connection_type"},{name:"Customer's Nature of Business",key:"cust_nature_of_business"},{name:"Customer NIN",key:"customer_nin"},{name:"Customer Supply Type",key:"customer_supply_type"},{name:"Customer Estimated Load",key:"customer_estimated_load"},{name:"Customer Has Meter",key:"cust_has_meter"},{name:"Customer Meter Category",key:"customer_meter_category"},{name:"Customer Meter Manufacturer",key:"customer_meter_manufacturer"},{name:"Customer Meter Sealed",key:"customer_meter_saled"},{name:"Customer Meter Accessible",key:"customer_meter_accessible"},{name:"Customer Meter Location",key:"customer_meter_location"},{name:"Customer Bill Name",key:"customer_bill_name"},{name:"Customer Has Account Number",key:"customer_has_account_no"},{name:"Customer Group",key:"customer_group"},{name:"Is Landlord",key:"is_landlord"},{name:"Landlord Name",key:"landlord_name"},{name:"Landlord Phone",key:"landlord_phone"},{name:"Tenant Name",key:"tenant_name"},{name:"Tenant Phone",key:"tenant_phone"},{name:"Meter CT Ratio",key:"meter_ct_ratio"}]}get totalSelectedRecords(){return this.selectedRecords.length}confirm1(e){this.confirmationService.confirm({target:e.target,message:"Are you sure you want to approve the selected record?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.approveDialog=!0},reject:()=>{}})}nextRecord(){if(this.currentIndex<this.selectedRecords.length-1){this.currentIndex++;let e=this.selectedRecords[this.currentIndex].uid;this.loadCustomerByUid(e)}else this.messageService.add({severity:"info",summary:"End of List",detail:"No more records to approve."})}confirm2(e){this.confirmationService.confirm({target:e.target,message:"Are you sure you want to reject the selected record??",header:"Reject Confirmation",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",accept:()=>{this.rejectDialog=!0},reject:()=>{}})}confirmReject(){let e={uid:this.currentRecord.newData.uid,approval_status:"Rejected",approval_comments:this.rejectReason};this.customerService.customerApproveOrReject(e).subscribe(i=>{this.messageService.add({severity:"success",summary:"Record Rejected",detail:"Customer record has been rejected."}),this.rejectDialog=!1,this.rejectReason="",this.removeCurrentRecordAndRedirectIfEmpty()},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.errorMessage||"Error updating the customer approval status."})})}confirmApprove(){let e={uid:this.currentRecord.newData.uid,approval_status:"Approved",approval_comments:this.approveReason};this.customerService.customerApproveOrReject(e).subscribe(i=>{this.messageService.add({severity:"success",summary:"Record Approved",detail:"Customer record has been approved."}),this.approveDialog=!1,this.approveReason="",this.removeCurrentRecordAndRedirectIfEmpty()},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.error.errorMessage||"Error updating the customer approval status."})})}removeCurrentRecordAndRedirectIfEmpty(){let e=this.selectedRecords.findIndex(i=>i.uid===this.currentRecord.newData.uid);e!==-1&&this.selectedRecords.splice(e,1),this.selectedRecords.length===0?(this.utilService.clearItems(),this.redirectToDataValidation()):this.onSelectedRecordChange(this.selectedRecords[0])}ngOnInit(){this.loadData()}loadData(){this.selectedRecords=this.utilService.getItems(),this.activatedRoute.paramMap.subscribe(e=>{let i=e.get("uid");i&&(this.loadCustomerByUid(i),console.log(i))})}loadCustomerByUid(e){this.customerService.getCustomerById(e).subscribe(i=>{i.code===200&&(this.currentRecord={newData:i.data.new,oldData:i.data.old},this.events=this.currentRecord.newData.events,this.qrCode=this.currentRecord.newData.qr_code)},i=>{console.error("Error fetching customer data:",i)})}onSelectedRecordChange(e){this.currentIndex=this.selectedRecords.indexOf(e),this.router.navigate(["../",e.uid],{relativeTo:this.activatedRoute}).then(()=>{console.log("Navigation successful to:",e.uid)})}previousRecord(){this.currentIndex>0&&(this.currentIndex--,this.currentRecord=this.selectedRecords[this.currentIndex])}approveRecord(){this.reviewDialog=!0}rejectRecord(){this.rejectDialog=!0}confirmReview(){console.log("Review Comments:",this.comments),this.reviewDialog=!1,this.nextRecord()}cancelReject(){this.rejectDialog=!1}cancelReview(){this.reviewDialog=!1}isFirstRecord(){return this.currentIndex===0}setCurrentRecord(){if(this.selectedRecords.length>0){let e=this.selectedRecords[0].uid;this.loadCustomerByUid(e)}else this.redirectToDataValidation()}redirectToDataValidation(){this.messageService.add({severity:"info",summary:"No more records to process",detail:"Redirecting to data validation page."}),this.router.navigate(["/app/data-validation"])}isLastRecord(){return this.currentIndex===this.selectedRecords.length-1}static{this.\u0275fac=function(i){return new(i||o)(_(j),_(et),_(x),_(T),_(H),_(ue),_(U),_(de))}}static{this.\u0275cmp=I({type:o,selectors:[["app-data-verification"]],features:[k([x,T])],decls:54,vars:30,consts:[["dt",""],[1,"card","base"],[1,"flex","justify-content-between","pb-3","mb-4","border-300","border-bottom-1"],[1,"flex","flex-column","p-0","m-0"],[1,"-mt-1"],[1,"flex","flex-wrap","gap-3"],["pButton","","label","Reject Selection",1,"p-button-danger",3,"click","outlined"],["pButton","","label","Approve Selection",1,"p-button-success",3,"click","outlined"],["pButton","","label","Review All","disabled","",1,"p-button-primary",3,"click","outlined"],[1,"grid","max-h-33rem"],[1,"col-2","h-auto","overflow-x-hidden","w-12rem","p-0","m-0","pl-5"],[1,"selected-records-list"],["styleClass","p-datatable-striped","scrollHeight","400px",3,"onRowSelect","value","globalFilterFields","rows","scrollable"],["pTemplate","header"],["pTemplate","body"],[1,"col-none","md:col-1","m-0","p-0"],["layout","vertical"],[1,"col-4","h-30rem","overflow-scroll","overflow-x-hidden"],["align","alternate","styleClass","customized-timeline",3,"value"],["pTemplate","marker"],["pTemplate","content"],["class","col-5",4,"ngIf"],["header","Review Record",3,"visibleChange","visible"],[1,"p-field"],[1,"field","col","flex","flex-column","gap-2"],["pInputTextarea","","rows","5",3,"ngModelChange","ngModel"],[1,"p-mt-2","flex","gap-4"],["pButton","","label","Approve",1,"p-button-success",3,"click"],["pButton","","label","Cancel",1,"p-button-secondary",3,"click"],["header","Rejection Reason",3,"visibleChange","visible"],[1,"field","flex","flex-column","gap-3"],["for","rejectionReason"],["id","rejectionReason","pInputTextarea","","rows","4","required","",3,"ngModelChange","ngModel"],["class","p-error",4,"ngIf"],[1,"p-mt-2","flex","gap-4","justify-content-end"],["pButton","","label","Submit",1,"p-button-danger",3,"click","disabled"],["header","Approval Reason",3,"visibleChange","visible"],["pButton","","label","Submit",1,"p-button-success",3,"click","disabled"],["pSortableColumn","customer_no",2,"min-width","20rem"],["field","customer_no"],[1,"cursor-pointer",3,"click","ngClass"],[1,"flex","w-2rem","h-2rem","align-items-center","justify-content-center","text-white","border-circle","z-1","shadow-1"],[1,"pi","pi-inbox"],[1,"card","w-100%"],[1,"text-xs"],[1,"col-5"],[1,"p-formgrid","grid","h-30rem","overflow-scroll","overflow-x-hidden"],["class","field col-6 flex flex-column gap-2 field-container",4,"ngFor","ngForOf"],[1,"col-12","flex","justify-content-center"],["class","qr-code",4,"ngIf"],[1,"field","col-6","flex","flex-column","gap-2","field-container"],["class","data new-data",4,"ngIf"],["class","data existing-data",4,"ngIf"],[1,"data","new-data"],[1,"data","existing-data"],[1,"qr-code"],["alt","Customer QR Code","width","300px",1,"qr-code-image",3,"src"],[1,"p-error"]],template:function(i,t){if(i&1){let l=R();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),c(4,"Checker"),r(),n(5,"h6",4),c(6),r()(),n(7,"div",5),C(8,"p-toast")(9,"p-confirmPopup"),n(10,"button",6),g("click",function(a){return d(l),m(t.confirm2(a))}),r(),n(11,"button",7),g("click",function(a){return d(l),m(t.confirm1(a))}),r(),n(12,"button",8),g("click",function(){return d(l),m(t.approveRecord())}),r()()(),n(13,"div",9)(14,"div",10)(15,"div",11)(16,"p-table",12,0),g("onRowSelect",function(a){return d(l),m(t.onSelectedRecordChange(a.data))}),v(18,wt,4,0,"ng-template",13)(19,Dt,3,4,"ng-template",14),r()()(),n(20,"div",15),C(21,"p-divider",16),r(),n(22,"div",17)(23,"p-timeline",18),v(24,Mt,2,4,"ng-template",19)(25,Rt,22,8,"ng-template",20),r()(),v(26,It,5,2,"div",21),r(),n(27,"p-dialog",22),w("visibleChange",function(a){return d(l),S(t.reviewDialog,a)||(t.reviewDialog=a),m(a)}),C(28,"div",23),n(29,"div",24)(30,"label"),c(31,"Comments"),r(),n(32,"textarea",25),w("ngModelChange",function(a){return d(l),S(t.comments,a)||(t.comments=a),m(a)}),r()(),n(33,"div",26)(34,"button",27),g("click",function(){return d(l),m(t.confirmReview())}),r(),n(35,"button",28),g("click",function(){return d(l),m(t.cancelReview())}),r()()(),n(36,"p-dialog",29),w("visibleChange",function(a){return d(l),S(t.rejectDialog,a)||(t.rejectDialog=a),m(a)}),n(37,"div",30)(38,"label",31),c(39,"Reason for Rejection"),r(),n(40,"textarea",32),w("ngModelChange",function(a){return d(l),S(t.rejectReason,a)||(t.rejectReason=a),m(a)}),r(),v(41,kt,2,0,"small",33),r(),n(42,"div",34)(43,"button",35),g("click",function(){return d(l),m(t.confirmReject())}),r(),n(44,"button",28),g("click",function(){return d(l),m(t.cancelReject())}),r()()(),n(45,"p-dialog",36),w("visibleChange",function(a){return d(l),S(t.approveDialog,a)||(t.approveDialog=a),m(a)}),n(46,"div",30)(47,"label",31),c(48,"Reason for Approval"),r(),n(49,"textarea",32),w("ngModelChange",function(a){return d(l),S(t.approveReason,a)||(t.approveReason=a),m(a)}),r(),v(50,Et,2,0,"small",33),r(),n(51,"div",34)(52,"button",37),g("click",function(){return d(l),m(t.confirmApprove())}),r(),n(53,"button",28),g("click",function(){return d(l),m(t.cancelReject())}),r()()()()}i&2&&(s(6),M("Total item: ",t.totalSelectedRecords,""),s(4),p("outlined",!0),s(),p("outlined",!0),s(),p("outlined",!0),s(4),p("value",t.selectedRecords)("globalFilterFields",D(26,vt))("rows",100)("scrollable",!0),s(7),p("value",t.events),s(3),p("ngIf",t.currentRecord),s(),N(D(27,yt)),b("visible",t.reviewDialog),s(5),b("ngModel",t.comments),s(4),N(D(28,tt)),b("visible",t.rejectDialog),s(4),b("ngModel",t.rejectReason),s(),p("ngIf",!t.rejectReason&&t.rejectDialog),s(2),p("disabled",!t.rejectReason),s(2),N(D(29,tt)),b("visible",t.approveDialog),s(4),b("ngModel",t.approveReason),s(),p("ngIf",!t.approveReason&&t.approveDialog),s(2),p("disabled",!t.approveReason))},dependencies:[se,le,ce,O,he,we,xe,A,B,pe,L,W,Ee,Pe,Be,Ke,Je,qe,F],styles:[".p-dropdown{width:100%}.base[_ngcontent-%COMP%]{width:1050px}.field-container[_ngcontent-%COMP%]{margin-bottom:1rem}.label[_ngcontent-%COMP%]{font-weight:700}.data[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;margin-top:.5rem}.new-data[_ngcontent-%COMP%], .no-data[_ngcontent-%COMP%]{background-color:#e0ffe0}.existing-data[_ngcontent-%COMP%], .no-data-exist[_ngcontent-%COMP%]{background-color:#f0f0f0}.active-row[_ngcontent-%COMP%]{background-color:#e0dddd;color:#0d0d96;font-weight:700}.empty-data[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;margin-top:.5rem;background-color:#f0f0f0}.review[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;margin-top:1rem;border-radius:2px;margin-bottom:1rem;margin-right:.5rem}"]})}}return o})();var Pt=[{path:"",component:$e},{path:"data-verification/:uid",data:{breadcrum:"Data Verification"},component:it}],Mi=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=te({type:o})}static{this.\u0275inj=ee({imports:[z,K,z,K,Ae,Se,Xe,ve,Ce,Qe,be,Ue,ge,Ne,Te,Me,ze,Re,Le,Ie,Ve,De,ke,Q,J,We,He,me.forChild(Pt),Q,J,Ze]})}}return o})();export{Mi as DataValidationModule,Pt as dataValidationRoutes};
